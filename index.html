<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<title>Swiper demo</title>
		<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1" />
		<!-- Link Swiper's CSS -->
		<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />

		<!-- Demo styles -->
		<style>
			html,
			body {
				position: relative;
				height: 100%;
			}

			body {
				background: #eee;
				font-family: Helvetica Neue, Helvetica, Arial, sans-serif;
				font-size: 14px;
				color: #000;
				margin: 0;
				padding: 0;
			}

			.swiper {
				width: 100%;
				height: 100%;
			}

			.swiper-slide {
				text-align: center;
				font-size: 18px;
				background: #fff;
				display: flex;
				justify-content: center;
				align-items: center;
			}

			.swiper-slide img {
				display: block;
				width: 100%;
				height: 100%;
				object-fit: cover;
			}

			.swiper-v {
				background: #eee;
			}
		</style>
	</head>

	<body>
		<!-- Swiper -->

		<div class="swiper mySwiper swiper-v">
			<div class="swiper-wrapper">
				<div class="swiper-slide">V0</div>
				<div class="swiper-slide">V1</div>
				<div class="swiper-slide">V2</div>
				<div class="swiper-slide">V3</div>
				<div class="swiper-slide v-sections">
					<div class="swiper mySwiper2 swiper-h">
						<div class="swiper-wrapper">
							<div class="swiper-slide">H0</div>
							<div class="swiper-slide">H1</div>
							<div class="swiper-slide">H2</div>
							<div class="swiper-slide">H3</div>
							<div class="swiper-slide">H4</div>
						</div>
						<div class="swiper-pagination"></div>
					</div>
				</div>
				<div class="swiper-slide">V4</div>
			</div>
			<div class="swiper-pagination"></div>
		</div>

		<!-- Swiper JS -->
		<script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>

		<!-- Initialize Swiper -->
		<script>
			// 동적으로 인덱스 파악
			const vSlides = document.querySelectorAll('.swiper-v .swiper-slide');
			const vSectionIndex = Array.from(vSlides).findIndex(slide => slide.classList.contains('v-sections'));
			const vLastIndex = vSlides.length - 1;

			const hSlides = document.querySelectorAll('.swiper-h .swiper-slide');
			const hFirstIndex = 0;
			const hLastIndex = hSlides.length - 1;

			// 가로 Swiper
			var swiperH = new Swiper('.swiper-h', {
				spaceBetween: 50,
				mousewheel: false, // 처음엔 비활성화
				pagination: {
					el: '.swiper-pagination',
					clickable: true,
				},
			});

			// 세로 Swiper
			var swiperV = new Swiper('.swiper-v', {
				direction: 'vertical',
				spaceBetween: 50,
				mousewheel: true,
				pagination: {
					el: '.swiper-pagination',
					clickable: true,
				},
				on: {
					slideChange: function () {
						if (this.activeIndex === vSectionIndex) {
							this.mousewheel.disable();
							swiperH.mousewheel.disable();
							setTimeout(() => {
								swiperH.mousewheel.enable();
							}, 500);
						} else {
							this.mousewheel.enable();
							swiperH.mousewheel.disable();
						}
					},
				},
			});

			// 가로 Swiper에서 vSectionIndex+1(마지막)로, hFirstIndex(처음)로 이동
			swiperH.on('slideChange', function () {
				// 마지막에서 down
				if (swiperH.activeIndex === hLastIndex) {
					swiperH.el.addEventListener('wheel', goToNextVertical, { passive: false });
				} else {
					swiperH.el.removeEventListener('wheel', goToNextVertical, { passive: false });
				}
				// 처음에서 up
				if (swiperH.activeIndex === hFirstIndex) {
					swiperH.el.addEventListener('wheel', goToPrevVertical, { passive: false });
				} else {
					swiperH.el.removeEventListener('wheel', goToPrevVertical, { passive: false });
				}
			});

			function goToNextVertical(e) {
				if (e.deltaY > 0) {
					swiperV.slideTo(vSectionIndex + 1); // v-sections 다음 슬라이드
					swiperH.mousewheel.disable();
					swiperV.mousewheel.enable();
					swiperH.el.removeEventListener('wheel', goToNextVertical, { passive: false });
					e.preventDefault();
				}
			}

			function goToPrevVertical(e) {
				if (e.deltaY < 0) {
					swiperV.slideTo(vSectionIndex); // v-sections 슬라이드
					swiperH.mousewheel.disable();
					swiperV.mousewheel.enable();
					swiperH.el.removeEventListener('wheel', goToPrevVertical, { passive: false });
					e.preventDefault();
				}
			}
		</script>
	</body>
</html>
